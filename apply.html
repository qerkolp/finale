<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <title>Whitelist - City of Prague</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav>
        <div class="nav-left">
            <img src="praharp.png" class="logo-img">
            <div class="logo-text">CITY OF PRAGUE</div>
        </div>
        <div class="nav-links">
            <a href="index.html">Domů</a>
            <a href="team.html">A-Team</a>
            <a href="devs.html">DEV-Team</a>
            <a href="apply.html" class="active">Whitelist</a>
            <a href="admin.html" id="admin-link" class="hidden" style="color:var(--accent)">Admin</a>
            <a href="editor.html" id="editor-link" class="hidden" style="color:var(--primary)">Editor</a>
            <a href="login.html" class="btn-nav" id="nav-btn">Přihlásit</a>
        </div>
    </nav>

    <div class="container">
        <h1 style="text-align: center; color: var(--primary);">WHITELIST TEST</h1>
        <p style="text-align: center; color: #aaa; margin-bottom: 30px;">Vyplň pravdivě. Odpovědi kontrolujeme ručně.
        </p>

        <div class="form-container" style="max-width: 800px; margin: 0 auto;">

            <h3 style="border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 20px;">1. Základní informace
            </h3>

            <label style="color:var(--primary); font-weight:bold;">Discord Tag (včetně #1234 nebo nové jméno)</label>
            <input type="text" id="discord" placeholder="pepa_z_depa">

            <div style="display:flex; gap:15px;">
                <div style="flex:1">
                    <label style="color:var(--primary); font-weight:bold;">Věk OOC</label>
                    <input type="number" id="age_ooc" placeholder="15+">
                </div>
                <div style="flex:1">
                    <label style="color:var(--primary); font-weight:bold;">Zkušenosti</label>
                    <select id="experience" style="background: #1e1e2f;">
                        <option value="zacatecnik">Začátečník</option>
                        <option value="pokrocily">Pokročilý</option>
                        <option value="expert">Expert</option>
                    </select>
                </div>
            </div>

            <h3 style="border-bottom: 1px solid #333; padding-bottom: 10px; margin: 30px 0 20px;">2. Motivace</h3>

            <label style="font-weight:bold;">Proč chceš RPit zrovna u nás?</label>
            <textarea id="why_us" style="height:80px;"></textarea>

            <label style="font-weight:bold;">Co plánuješ za postavu a co budeš RPit?</label>
            <textarea id="rp_plans" style="height:80px;"></textarea>

            <h3 style="border-bottom: 1px solid #333; padding-bottom: 10px; margin: 30px 0 20px;">3. Znalost Pravidel
            </h3>

            <label style="font-weight:bold; color:var(--accent);">Co je to Roleplay (RP)?</label>
            <textarea id="def_rp" style="height:100px;" placeholder="Definuj svými slovy..."></textarea>

            <label style="font-weight:bold; color:var(--accent);">Co je to Metagaming (MG)?</label>
            <textarea id="def_mg" style="height:100px;"></textarea>

            <label style="font-weight:bold; color:var(--accent);">Co je to FailRP?</label>
            <textarea id="def_failrp" style="height:100px;"></textarea>

            <label style="font-weight:bold; color:var(--accent);">Co je to CK a jaké máme druhy?</label>
            <textarea id="def_ck" style="height:100px;"></textarea>

            <label style="font-weight:bold; color:var(--accent);">Co je to PK a jaké máme druhy?</label>
            <textarea id="def_pk" style="height:100px;"></textarea>

            <label style="font-weight:bold; color:var(--accent);">Na jaký typ PK je potřeba schválení ticketem?</label>
            <input type="text" id="pk_ticket">

            <button onclick="send()" class="btn-submit" style="margin-top:30px;">ODESLAT KONTROLE</button>
            <p id="status" style="text-align: center; margin-top: 15px; font-weight: bold;"></p>
        </div>
    </div>

    <script src="nav.js"></script>
    <script>
        async function send() {
            const btn = document.querySelector('button');
            const status = document.getElementById('status');
            btn.disabled = true; btn.innerText = "ODESÍLÁM..."; status.innerText = "";

            // Sbírání dat
            const fields = ['discord', 'age_ooc', 'experience', 'why_us', 'rp_plans', 'def_rp', 'def_mg', 'def_failrp', 'def_ck', 'def_pk', 'pk_ticket'];
            const data = {};
            let empty = false;

            fields.forEach(f => {
                const el = document.getElementById(f);
                data[f] = el.value;
                if (!data[f]) empty = true;
            });

            if (empty) {
                status.innerText = "❌ Vyplň prosím všechna pole!"; status.style.color = "#ff5555";
                btn.disabled = false; btn.innerText = "ODESLAT KONTROLE"; return;
            }

            try {
                const res = await fetch('/.netlify/functions/submit', { method: 'POST', body: JSON.stringify(data) });
                if (res.ok) {
                    status.innerText = "✅ Odesláno! Vyčkej na vyhodnocení na Discordu."; status.style.color = "#00ff41";
                    document.querySelectorAll('input, textarea').forEach(el => el.value = '');
                } else {
                    status.innerText = "❌ Chyba serveru."; status.style.color = "#ff5555";
                }
            } catch (err) { status.innerText = "❌ Chyba připojení."; }

            btn.disabled = false; btn.innerText = "ODESLAT KONTROLE";
        }
    </script>
</body>

</html>